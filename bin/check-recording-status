#!/bin/bash

MONITOR="$WAYBAR_OUTPUT_NAME"

# Fallback (in case script is run manually)
if [ -z "$MONITOR" ]; then
    MONITOR=$(/usr/bin/hyprctl -j monitors | /usr/bin/jq -r '.[] | select(.focused==true) | .name')
fi

if /usr/bin/pgrep -fa gpu-screen-recorder | /usr/bin/grep -qi -- "$MONITOR"; then
    echo '{"text":"󰑋","class":"recording","tooltip":"Recording this monitor"}'
else
    echo '{"text":"󰑊","class":"idle","tooltip":"Not recording this monitor"}'
fi
